<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>README Template: web_server.WebApp Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="template.css">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="template.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="GnuLinuxLogo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">README Template
   </div>
   <div id="projectbrief">Documentation</div>
   <!-- Sezione download / GitHub -->
<div id="custom-header-download" class="custom-header-download"> 
    <div id="custom-footer-download" class="custom-footer-download">
        <a href="https://github.com/Unix69/README-Template/archive/refs/heads/main.zip" 
            class="btn-download" target="_blank">‚¨áÔ∏è Download</a>
        <a href="https://github.com/Unix69/EmbeddedDocsTemplates" 
            class="btn-github" target="_blank">üêô View on GitHub</a>
    </div>
</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classweb__server_1_1WebApp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classweb__server_1_1WebApp-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">web_server.WebApp Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for web_server.WebApp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classweb__server_1_1WebApp__coll__graph.svg" width="312" height="548"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afe0d408b7ee54bb69fbd8863c9869920" id="r_afe0d408b7ee54bb69fbd8863c9869920"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#afe0d408b7ee54bb69fbd8863c9869920">__init__</a> (self, str <a class="el" href="classweb__server_1_1WebApp.html#a3453866068dea979ca6e6684fc774fbd">tg_bot_webhook_method</a>, str <a class="el" href="classweb__server_1_1WebApp.html#ac7c34c719a5f7a30c7068bc7991f4156">fb_bot_webhook_method</a>, str wp_bot_webhook_method, str <a class="el" href="classweb__server_1_1WebApp.html#a986335c380cfdfecc78f5d612f73f87c">srv_reservation_method</a>, str <a class="el" href="classweb__server_1_1WebApp.html#ad269ae2bcc4a269d7f52b3077d5f331d">srv_event_info_method</a>, str <a class="el" href="classweb__server_1_1WebApp.html#a2e3055f783fdad0070c444d258abd3af">srv_shutdown_method</a>, <a class="el" href="classweb__server_1_1WebApp.html#a305d98e65ac1e5363e83a0a9fafcab3a">srv_proto</a>=&quot;https&quot;, srv_name=&quot;ChatbotApp&quot;, <a class="el" href="classweb__server_1_1WebApp.html#a33d43f30c0f191b2d0648d5fb055821c">srv_host</a>=&quot;127.0.0.1&quot;, <a class="el" href="classweb__server_1_1WebApp.html#af120abb2c4437b28e85f481f2523f50c">srv_port</a>=5000, debug=True)</td></tr>
<tr class="separator:afe0d408b7ee54bb69fbd8863c9869920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857b65105ee8b50f7e981cbde3e96c8f" id="r_a857b65105ee8b50f7e981cbde3e96c8f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a857b65105ee8b50f7e981cbde3e96c8f">configure</a> (self)</td></tr>
<tr class="separator:a857b65105ee8b50f7e981cbde3e96c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cce6ba1e1a44470e642999fc1bec514" id="r_a4cce6ba1e1a44470e642999fc1bec514"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a4cce6ba1e1a44470e642999fc1bec514">start</a> (self, **kwargs)</td></tr>
<tr class="separator:a4cce6ba1e1a44470e642999fc1bec514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b330da0dc4521360db9cf1132aff39" id="r_ad0b330da0dc4521360db9cf1132aff39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#ad0b330da0dc4521360db9cf1132aff39">stop</a> (self)</td></tr>
<tr class="separator:ad0b330da0dc4521360db9cf1132aff39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a83dca41a9804d8149bbbae5dfc0b1" id="r_aa4a83dca41a9804d8149bbbae5dfc0b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#aa4a83dca41a9804d8149bbbae5dfc0b1">verify</a> (self)</td></tr>
<tr class="separator:aa4a83dca41a9804d8149bbbae5dfc0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac7c34c719a5f7a30c7068bc7991f4156" id="r_ac7c34c719a5f7a30c7068bc7991f4156"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#ac7c34c719a5f7a30c7068bc7991f4156">fb_bot_webhook_method</a></td></tr>
<tr class="separator:ac7c34c719a5f7a30c7068bc7991f4156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad269ae2bcc4a269d7f52b3077d5f331d" id="r_ad269ae2bcc4a269d7f52b3077d5f331d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#ad269ae2bcc4a269d7f52b3077d5f331d">srv_event_info_method</a></td></tr>
<tr class="separator:ad269ae2bcc4a269d7f52b3077d5f331d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33d43f30c0f191b2d0648d5fb055821c" id="r_a33d43f30c0f191b2d0648d5fb055821c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a33d43f30c0f191b2d0648d5fb055821c">srv_host</a></td></tr>
<tr class="separator:a33d43f30c0f191b2d0648d5fb055821c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af120abb2c4437b28e85f481f2523f50c" id="r_af120abb2c4437b28e85f481f2523f50c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#af120abb2c4437b28e85f481f2523f50c">srv_port</a></td></tr>
<tr class="separator:af120abb2c4437b28e85f481f2523f50c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305d98e65ac1e5363e83a0a9fafcab3a" id="r_a305d98e65ac1e5363e83a0a9fafcab3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a305d98e65ac1e5363e83a0a9fafcab3a">srv_proto</a></td></tr>
<tr class="separator:a305d98e65ac1e5363e83a0a9fafcab3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986335c380cfdfecc78f5d612f73f87c" id="r_a986335c380cfdfecc78f5d612f73f87c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a986335c380cfdfecc78f5d612f73f87c">srv_reservation_method</a></td></tr>
<tr class="separator:a986335c380cfdfecc78f5d612f73f87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b1133c0c3d6ae5bcbb185a114bd605" id="r_a25b1133c0c3d6ae5bcbb185a114bd605"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a25b1133c0c3d6ae5bcbb185a114bd605">srv_shutdown_api</a></td></tr>
<tr class="separator:a25b1133c0c3d6ae5bcbb185a114bd605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3055f783fdad0070c444d258abd3af" id="r_a2e3055f783fdad0070c444d258abd3af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a2e3055f783fdad0070c444d258abd3af">srv_shutdown_method</a></td></tr>
<tr class="separator:a2e3055f783fdad0070c444d258abd3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3453866068dea979ca6e6684fc774fbd" id="r_a3453866068dea979ca6e6684fc774fbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a3453866068dea979ca6e6684fc774fbd">tg_bot_webhook_method</a></td></tr>
<tr class="separator:a3453866068dea979ca6e6684fc774fbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63787c15c6de39b65ed8af8d77a67ebd" id="r_a63787c15c6de39b65ed8af8d77a67ebd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a63787c15c6de39b65ed8af8d77a67ebd">webApp</a></td></tr>
<tr class="separator:a63787c15c6de39b65ed8af8d77a67ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1363b6fa76b54ba02f258305c40c3a05" id="r_a1363b6fa76b54ba02f258305c40c3a05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a1363b6fa76b54ba02f258305c40c3a05">webapp_logger</a></td></tr>
<tr class="separator:a1363b6fa76b54ba02f258305c40c3a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193a8e3946cccec4f4f03639996a1155" id="r_a193a8e3946cccec4f4f03639996a1155"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a193a8e3946cccec4f4f03639996a1155">webapp_thread</a></td></tr>
<tr class="separator:a193a8e3946cccec4f4f03639996a1155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4679d81d01a436a228b43d1e089e672" id="r_ac4679d81d01a436a228b43d1e089e672"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#ac4679d81d01a436a228b43d1e089e672">wp_webhook_method</a></td></tr>
<tr class="separator:ac4679d81d01a436a228b43d1e089e672"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a26c3a90dc19e72de409e728a750a6d24" id="r_a26c3a90dc19e72de409e728a750a6d24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classweb__server_1_1WebApp.html#a26c3a90dc19e72de409e728a750a6d24">_register_routes</a> (self)</td></tr>
<tr class="separator:a26c3a90dc19e72de409e728a750a6d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00043">43</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afe0d408b7ee54bb69fbd8863c9869920" name="afe0d408b7ee54bb69fbd8863c9869920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0d408b7ee54bb69fbd8863c9869920">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>tg_bot_webhook_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>fb_bot_webhook_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>wp_bot_webhook_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>srv_reservation_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>srv_event_info_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>srv_shutdown_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>srv_proto</em> = <code>&quot;https&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>srv_name</em> = <code>&quot;ChatbotApp&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>srv_host</em> = <code>&quot;127.0.0.1&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>srv_port</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>debug</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00044">44</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>                 srv_proto=<span class="stringliteral">&quot;https&quot;</span>, srv_name=<span class="stringliteral">&quot;ChatbotApp&quot;</span>, srv_host=<span class="stringliteral">&quot;127.0.0.1&quot;</span>, srv_port=5000, debug=<span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">   46</span>        self.srv_host = srv_host</div>
<div class="line"><span class="lineno">   47</span>        self.srv_port = srv_port</div>
<div class="line"><span class="lineno">   48</span>        self.srv_proto = srv_proto</div>
<div class="line"><span class="lineno">   49</span>        self.webApp = Flask(srv_name)</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>        self.tg_bot_webhook_method = tg_bot_webhook_method</div>
<div class="line"><span class="lineno">   52</span>        self.fb_bot_webhook_method = fb_bot_webhook_method</div>
<div class="line"><span class="lineno">   53</span>        self.wp_webhook_method = wp_bot_webhook_method</div>
<div class="line"><span class="lineno">   54</span>        self.srv_reservation_method = srv_reservation_method</div>
<div class="line"><span class="lineno">   55</span>        self.srv_event_info_method = srv_event_info_method</div>
<div class="line"><span class="lineno">   56</span>        self.srv_shutdown_method = srv_shutdown_method</div>
<div class="line"><span class="lineno">   57</span>        self.srv_shutdown_api = f<span class="stringliteral">&quot;{self.srv_proto}://{self.srv_host}:{self.srv_port}/{self.srv_shutdown_method}&quot;</span></div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>        self.webapp_thread = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   60</span>        </div>
<div class="line"><span class="lineno">   61</span>        self.webapp_logger = Logger(name=<span class="stringliteral">&quot;webapp&quot;</span>, enable_file_handler=<span class="keyword">True</span>, enable_syslog_handler=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   62</span>        self.webapp_logger.config()</div>
<div class="line"><span class="lineno">   63</span>        </div>
<div class="line"><span class="lineno">   64</span>        self._register_routes()</div>
<div class="line"><span class="lineno">   65</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a26c3a90dc19e72de409e728a750a6d24" name="a26c3a90dc19e72de409e728a750a6d24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c3a90dc19e72de409e728a750a6d24">&#9670;&#160;</a></span>_register_routes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp._register_routes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00066">66</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>    <span class="keyword">def </span>_register_routes(self):</div>
<div class="line"><span class="lineno">   67</span>        <span class="preprocessor">@self.webApp.route(self.tg_bot_webhook_method, methods=[&quot;POST&quot;])</span></div>
<div class="line"><span class="lineno">   68</span>        <span class="keyword">def </span>telegram_webhook():</div>
<div class="line"><span class="lineno">   69</span>            <span class="keywordflow">if</span> request.method == <span class="stringliteral">&#39;POST&#39;</span>:</div>
<div class="line"><span class="lineno">   70</span>                </div>
<div class="line"><span class="lineno">   71</span>                update = request.json  <span class="comment"># Ricezione dei dati via webhook</span></div>
<div class="line"><span class="lineno">   72</span>                chat_id = update[<span class="stringliteral">&quot;message&quot;</span>][<span class="stringliteral">&quot;chat&quot;</span>][<span class="stringliteral">&quot;id&quot;</span>]</div>
<div class="line"><span class="lineno">   73</span>                user_id = update[<span class="stringliteral">&quot;message&quot;</span>][<span class="stringliteral">&quot;from&quot;</span>][<span class="stringliteral">&quot;id&quot;</span>]</div>
<div class="line"><span class="lineno">   74</span>                received_message = update[<span class="stringliteral">&quot;message&quot;</span>][<span class="stringliteral">&quot;text&quot;</span>]  <span class="comment"># Messaggio ricevuto</span></div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>                <span class="comment"># Ottieni la data e l&#39;ora corrente</span></div>
<div class="line"><span class="lineno">   77</span>                current_datetime = datetime.now()</div>
<div class="line"><span class="lineno">   78</span>                current_date = current_datetime.strftime(<span class="stringliteral">&quot;%A, %d %B %Y&quot;</span>)  <span class="comment"># Giorno, data (es. Luned√¨, 26 Aprile 2025)</span></div>
<div class="line"><span class="lineno">   79</span>                current_time_str = current_datetime.strftime(<span class="stringliteral">&quot;%H:%M:%S&quot;</span>)  <span class="comment"># Ora in formato HH:MM:SS</span></div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>                bot = bot_manager.create_if_not_exist_and_start_bot(<span class="stringliteral">&quot;telegram&quot;</span>, id=chat_id)</div>
<div class="line"><span class="lineno">   82</span>                bot_manager.get_bot(<span class="stringliteral">&quot;telegram&quot;</span>, chat_id).receive_message(payload=received_message, datetime=current_datetime)</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>                session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()  <span class="comment"># &lt;&lt;--- crea la sessione</span></div>
<div class="line"><span class="lineno">   85</span>                eventi = session.query(<a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>).all()</div>
<div class="line"><span class="lineno">   86</span>                eventi_str = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">   87</span>                <span class="keywordflow">for</span> evento <span class="keywordflow">in</span> eventi:</div>
<div class="line"><span class="lineno">   88</span>                    eventi_str += f<span class="stringliteral">&quot;Evento: {evento.name}\n&quot;</span></div>
<div class="line"><span class="lineno">   89</span>                    eventi_str += f<span class="stringliteral">&quot;Descrizione: {evento.description}\n&quot;</span></div>
<div class="line"><span class="lineno">   90</span>                    eventi_str += f<span class="stringliteral">&quot;Data e Ora: {evento.date_time.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;)}\n&quot;</span></div>
<div class="line"><span class="lineno">   91</span>                    eventi_str += f<span class="stringliteral">&quot;Location: {evento.location}\n&quot;</span></div>
<div class="line"><span class="lineno">   92</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Totali: {evento.total_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">   93</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Disponibili: {evento.available_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">   94</span>                    eventi_str += <span class="stringliteral">&quot;---------------------------\n&quot;</span> </div>
<div class="line"><span class="lineno">   95</span>            </div>
<div class="line"><span class="lineno">   96</span>                <span class="comment"># event_str = database.get_events()</span></div>
<div class="line"><span class="lineno">   97</span>                <span class="comment"># respose = ai.process_message(received_message, event_str)</span></div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>                <span class="comment"># TODO fare una funzione AI che accetta come parametro la event_str e tutti quelli necessari da request (contenuto in weebhok) e torna il messaggio al webhook, da ioltrare, </span></div>
<div class="line"><span class="lineno">  100</span>                prompt2=f<span class="stringliteral">&#39;&#39;&#39;Se l&#39;utente sta prenotando uno degli eventi in &quot;{eventi_str}&quot; nel suo messaggio: &quot;{received_message}&quot;, estrai le informazioni che ti fornisce e se non le d√† tutte, omettile. Foriscile nella forma:</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">                nome: ..., </span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">                evento: ..., </span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">                numero posti: .... </span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">                In questo messaggio fornisci SOLO le info che ti sono state fornite in &quot;{received_message}&quot; senza altre parole in una unica riga.&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  105</span>                booking_state = <a class="code hl_function" href="namespacellm.html#a92bfc5a8d1c0a36739d7d6422dcd00f1">llm.ask_llm3</a>(user_id, prompt2)</div>
<div class="line"><span class="lineno">  106</span>                info_message = f<span class="stringliteral">&quot;{booking_state}&quot;</span></div>
<div class="line"><span class="lineno">  107</span>                print(f<span class="stringliteral">&quot;Stato prenotazione utente {user_id}: {booking_state}&quot;</span>)</div>
<div class="line"><span class="lineno">  108</span>                user_info = <a class="code hl_function" href="namespacellm.html#ab5107623e8d5c3a898f4576ec17b294b">llm.info_extraction</a>(user_id, info_message)</div>
<div class="line"><span class="lineno">  109</span>                print(f<span class="stringliteral">&quot;Stato prenotazione utente {user_id}: {user_info}&quot;</span>)</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>                <span class="keywordflow">if</span> all([user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>]]):</div>
<div class="line"><span class="lineno">  112</span>                    database.db.salva_prenotazione(user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>])</div>
<div class="line"><span class="lineno">  113</span>                    <span class="comment">#uil</span></div>
<div class="line"><span class="lineno">  114</span>                    <span class="comment"># Genera la risposta finale con GPT</span></div>
<div class="line"><span class="lineno">  115</span>                    prompt_finale = f<span class="stringliteral">&quot;Conferma la prenotazione per {user_info[&#39;name&#39;]} all&#39;evento {user_info[&#39;event&#39;]} con {user_info[&#39;number_sits&#39;]} posti.&quot;</span></div>
<div class="line"><span class="lineno">  116</span>                    <span class="comment">#standard_text = f&quot;{prompt_finale}&quot;</span></div>
<div class="line"><span class="lineno">  117</span>                    bot.send_message(chat_id, prompt_finale)</div>
<div class="line"><span class="lineno">  118</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  119</span>                    prompt = f<span class="stringliteral">&#39;&#39;&#39;L&#39;utente ha scritto: &quot;{received_message}&quot;, il giorno √® &quot;{current_date}&quot; e l&#39;ora √® &quot;{current_time_str}&quot;.</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">                    Per prenotare l&#39;utente deve fornire nome, cognome, evento e numero posti, non necessariamente in un unico messaggio, fino a riempire tutti i campi del dizionario &quot;{user_info}&quot;. </span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">                    Questa √® la tabella degli eventi &quot;{eventi_str}&quot;.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">                    Se il numero di posti richiesti per uno degli eventi disponibili in &quot;{eventi_str}&quot; √® maggiore dei posti disponibili, rispondi con &quot;Posti non disponibili&quot; e dicendo quanti posti disponibili rimangono. </span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">                    Se l&#39;utente chiede informazioni sugli eventi disponibili in &quot;{eventi_str}&quot;, forniscigliele dando SOLO le info che ti sta chiedendo e includendo qualche emoji.</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">                    Solo al primo messaggio presentati come Chat CPI, il chatbot ufficiale del circolo Peppino Impastato. </span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">                    Usa un linguaggio inclusivo con la schwa (…ô).</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">                    Rendi la risposta il pi√π sintentica possibile.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">                    Non dare MAI il messaggio di prenotazione effettuata.</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">                    Se l&#39;utente vuole cancellare una prenotazione, devi dire di rivolgersi al numero 3276233773</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">                    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  130</span>                    answer = <a class="code hl_function" href="namespacellm.html#a71ee9b464f51902803dbeb01d9396b22">llm.ask_llm</a>(user_id, prompt)</div>
<div class="line"><span class="lineno">  131</span>                    </div>
<div class="line"><span class="lineno">  132</span>                    bot_manager.get_bot(<span class="stringliteral">&quot;telegram&quot;</span>, chat_id).send_message(payload=f<span class="stringliteral">&quot;{answer}&quot;</span>)</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>                session.close()    </div>
<div class="line"><span class="lineno">  135</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;ok&quot;</span>, 200</div>
<div class="line"><span class="lineno">  136</span>            </div>
<div class="line"><span class="lineno">  137</span>        <span class="preprocessor">@self.webApp.route(self.fb_bot_webhook_method, methods=[&#39;GET&#39;, &#39;POST&#39;])</span></div>
<div class="line"><span class="lineno">  138</span>        <span class="keyword">def </span>messenger_webhook():</div>
<div class="line"><span class="lineno">  139</span>            <span class="keywordflow">if</span> request.method == <span class="stringliteral">&#39;GET&#39;</span>:</div>
<div class="line"><span class="lineno">  140</span>                <span class="comment">#print(&quot;Token ricevuto da Facebook:&quot;, request.args.get(&#39;hub.verify_token&#39;))</span></div>
<div class="line"><span class="lineno">  141</span>                <span class="keywordflow">if</span> request.args.get(<span class="stringliteral">&#39;hub.verify_token&#39;</span>) == env.environ.FACEBOOK_TOKEN:</div>
<div class="line"><span class="lineno">  142</span>                    <span class="keywordflow">return</span> request.args.get(<span class="stringliteral">&#39;hub.challenge&#39;</span>), 200</div>
<div class="line"><span class="lineno">  143</span>                message = <span class="stringliteral">&quot;Benvenuto nella pagina di esempio Flask!&quot;</span></div>
<div class="line"><span class="lineno">  144</span>                <span class="keywordflow">return</span> render_template_string(web_client.html_home, message=message)</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>            <span class="keywordflow">elif</span> request.method == <span class="stringliteral">&#39;POST&#39;</span>:</div>
<div class="line"><span class="lineno">  147</span>                </div>
<div class="line"><span class="lineno">  148</span>                <span class="comment">#bot_manager.create_if_not_exist_bot(&quot;messenger&quot;, id=&quot;user1&quot;)</span></div>
<div class="line"><span class="lineno">  149</span>                </div>
<div class="line"><span class="lineno">  150</span>                data = request.get_json()</div>
<div class="line"><span class="lineno">  151</span>                <span class="comment">#print(&quot;Dati ricevuti da Facebook:&quot;, data)  # &lt;-- LOG IMPORTANTE</span></div>
<div class="line"><span class="lineno">  152</span>                session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()  <span class="comment"># &lt;&lt;--- crea la sessione</span></div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>                <span class="comment"># Ottieni la data e l&#39;ora corrente</span></div>
<div class="line"><span class="lineno">  155</span>                current_datetime = datetime.now()</div>
<div class="line"><span class="lineno">  156</span>                current_date = current_datetime.strftime(<span class="stringliteral">&quot;%A, %d %B %Y&quot;</span>)  <span class="comment"># Giorno, data (es. Luned√¨, 26 Aprile 2025)</span></div>
<div class="line"><span class="lineno">  157</span>                current_time_str = current_datetime.strftime(<span class="stringliteral">&quot;%H:%M:%S&quot;</span>)  <span class="comment"># Ora in formato HH:MM:SS</span></div>
<div class="line"><span class="lineno">  158</span>                            </div>
<div class="line"><span class="lineno">  159</span>                eventi = session.query(<a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>).all()</div>
<div class="line"><span class="lineno">  160</span>                eventi_str = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  161</span>                <span class="keywordflow">for</span> evento <span class="keywordflow">in</span> eventi:</div>
<div class="line"><span class="lineno">  162</span>                    eventi_str += f<span class="stringliteral">&quot;Evento: {evento.name}\n&quot;</span></div>
<div class="line"><span class="lineno">  163</span>                    eventi_str += f<span class="stringliteral">&quot;Descrizione: {evento.description}\n&quot;</span></div>
<div class="line"><span class="lineno">  164</span>                    eventi_str += f<span class="stringliteral">&quot;Data e Ora: {evento.date_time.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;)}\n&quot;</span></div>
<div class="line"><span class="lineno">  165</span>                    eventi_str += f<span class="stringliteral">&quot;Location: {evento.location}\n&quot;</span></div>
<div class="line"><span class="lineno">  166</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Totali: {evento.total_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">  167</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Disponibili: {evento.available_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">  168</span>                    eventi_str += <span class="stringliteral">&quot;---------------------------\n&quot;</span> </div>
<div class="line"><span class="lineno">  169</span>                </div>
<div class="line"><span class="lineno">  170</span>                <span class="comment"># Messaggio di risposta</span></div>
<div class="line"><span class="lineno">  171</span>                <span class="keywordflow">if</span> data.get(<span class="stringliteral">&#39;object&#39;</span>) == <span class="stringliteral">&#39;page&#39;</span>:</div>
<div class="line"><span class="lineno">  172</span>                    <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> data.get(<span class="stringliteral">&#39;entry&#39;</span>, []):</div>
<div class="line"><span class="lineno">  173</span>                        <span class="keywordflow">for</span> messaging_event <span class="keywordflow">in</span> entry.get(<span class="stringliteral">&#39;messaging&#39;</span>, []):</div>
<div class="line"><span class="lineno">  174</span>                            sender_id = messaging_event[<span class="stringliteral">&#39;sender&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>]</div>
<div class="line"><span class="lineno">  175</span>                            bot = bot_manager.create_if_not_exist_and_start_bot(<span class="stringliteral">&quot;telegram&quot;</span>, id=sender_id)</div>
<div class="line"><span class="lineno">  176</span>                            <span class="keywordflow">if</span> <span class="stringliteral">&#39;message&#39;</span> <span class="keywordflow">in</span> messaging_event <span class="keywordflow">and</span> <span class="stringliteral">&#39;text&#39;</span> <span class="keywordflow">in</span> messaging_event[<span class="stringliteral">&#39;message&#39;</span>]:</div>
<div class="line"><span class="lineno">  177</span>                                received_message = messaging_event[<span class="stringliteral">&#39;message&#39;</span>][<span class="stringliteral">&#39;text&#39;</span>]</div>
<div class="line"><span class="lineno">  178</span>                                <span class="comment"># Messaggio di risposta</span></div>
<div class="line"><span class="lineno">  179</span>                                bot_manager.get_bot(<span class="stringliteral">&quot;facebook&quot;</span>, sender_id).receive_message(payload=received_message, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  180</span>                                prompt2=f<span class="stringliteral">&#39;&#39;&#39;Se l&#39;utente sta prenotando uno degli eventi in &quot;{eventi_str}&quot; nel suo messaggio: &quot;{received_message}&quot;, estrai le informazioni che ti fornisce e se non le d√† tutte, omettile. Foriscile nella forma:</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">                                nome: ..., </span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">                                evento: ..., </span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">                                numero posti: .... </span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">                                In questo messaggio fornisci SOLO le info che ti sono state fornite in &quot;{received_message}&quot;  senza altre parole in una unica riga.&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  185</span>                                booking_state = <a class="code hl_function" href="namespacellm.html#a92bfc5a8d1c0a36739d7d6422dcd00f1">llm.ask_llm3</a>(sender_id, prompt2)</div>
<div class="line"><span class="lineno">  186</span>                                info_message = f<span class="stringliteral">&quot;{booking_state}&quot;</span></div>
<div class="line"><span class="lineno">  187</span>                                print(f<span class="stringliteral">&quot;Stato prenotazione utente {sender_id}: {booking_state}&quot;</span>)</div>
<div class="line"><span class="lineno">  188</span>                                user_info = database.db.info_extraction(sender_id, info_message)</div>
<div class="line"><span class="lineno">  189</span>                                print(f<span class="stringliteral">&quot;Stato prenotazione utente {sender_id}: {user_info}&quot;</span>)</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>                                <span class="keywordflow">if</span> all([user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>]]):</div>
<div class="line"><span class="lineno">  192</span>                                    database.db.salva_prenotazione(user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>])</div>
<div class="line"><span class="lineno">  193</span>                    </div>
<div class="line"><span class="lineno">  194</span>                                    <span class="comment"># Genera la risposta finale con GPT</span></div>
<div class="line"><span class="lineno">  195</span>                                    prompt_finale = f<span class="stringliteral">&quot;Conferma la prenotazione per {user_info[&#39;name&#39;]} all&#39;evento {user_info[&#39;event&#39;]} con {user_info[&#39;number_sits&#39;]} posti.&quot;</span></div>
<div class="line"><span class="lineno">  196</span>                                    <span class="comment">#standard_text = f&quot;{prompt_finale}&quot;</span></div>
<div class="line"><span class="lineno">  197</span>                                    bot_manager.get_bot(<span class="stringliteral">&quot;facebook&quot;</span>, sender_id).send_message(payload=prompt_finale, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  198</span>                                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  199</span>                                    prompt = f<span class="stringliteral">&#39;&#39;&#39;L&#39;utente ha scritto: &quot;{received_message}&quot;, il giorno √® &quot;{current_date}&quot; e l&#39;ora √® &quot;{current_time_str}&quot;.</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">                                    Per prenotare l&#39;utente deve fornire nome, cognome, evento e numero posti, non necessariamente in un unico messaggio, fino a riempire tutti i campi del dizionario &quot;{user_info}&quot;. </span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">                                    Questa √® la tabella degli eventi &quot;{eventi_str}&quot;.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">                                    Se il numero di posti richiesti per uno degli eventi disponibili in &quot;{eventi_str}&quot; √® maggiore dei posti disponibili, rispondi con &quot;Posti non disponibili&quot; e dicendo quanti posti disponibili rimangono. </span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">                                    Se l&#39;utente chiede informazioni sugli eventi disponibili in &quot;{eventi_str}&quot;, forniscigliele dando SOLO le info che ti sta chiedendo e includendo qualche emoji.</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">                                    Solo al primo messaggio presentati come Chat CPI, il chatbot ufficiale del circolo Peppino Impastato. </span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">                                    Usa un linguaggio inclusivo con la schwa (…ô).</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">                                    Rendi la risposta il pi√π sintentica possibile.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">                                    Non dare MAI il messaggio di prenotazione effettuata.</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">                                    Se l&#39;utente vuole cancellare una prenotazione, devi dire di rivolgersi al numero 3276233773</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">                                    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  210</span>                                    answer = <a class="code hl_function" href="namespacellm.html#a71ee9b464f51902803dbeb01d9396b22">llm.ask_llm</a>(sender_id, prompt)</div>
<div class="line"><span class="lineno">  211</span>                                    bot_manager.get_bot(<span class="stringliteral">&quot;facebook&quot;</span>, sender_id).send_message(payload=f<span class="stringliteral">&quot;{answer}&quot;</span>, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>                                session.close()    </div>
<div class="line"><span class="lineno">  214</span>                            </div>
<div class="line"><span class="lineno">  215</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;EVENT_RECEIVED&#39;</span>, 200</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>        <span class="preprocessor">@self.webApp.route(self.wp_webhook_method, methods=[&#39;GET&#39;, &#39;POST&#39;])</span></div>
<div class="line"><span class="lineno">  218</span>        <span class="keyword">def </span>whatsapp_webhook():</div>
<div class="line"><span class="lineno">  219</span>            </div>
<div class="line"><span class="lineno">  220</span>            <span class="keywordflow">if</span> request.method == <span class="stringliteral">&#39;GET&#39;</span>:</div>
<div class="line"><span class="lineno">  221</span>                <span class="keywordflow">if</span> request.args.get(<span class="stringliteral">&#39;hub.verify_token&#39;</span>) == env.environ.WHATSAPP_TOKEN:</div>
<div class="line"><span class="lineno">  222</span>                    <span class="keywordflow">return</span> request.args.get(<span class="stringliteral">&#39;hub.challenge&#39;</span>), 200</div>
<div class="line"><span class="lineno">  223</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;Invalid verification token&#39;</span>, 403</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">elif</span> request.method == <span class="stringliteral">&#39;POST&#39;</span>:</div>
<div class="line"><span class="lineno">  226</span>                data = request.get_json()</div>
<div class="line"><span class="lineno">  227</span>                <span class="comment">#print(&quot;Messaggio ricevuto da WhatsApp:&quot;, data)</span></div>
<div class="line"><span class="lineno">  228</span>                session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()  <span class="comment"># &lt;&lt;--- crea la sessione</span></div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>                <span class="comment"># Ottieni la data e l&#39;ora corrente</span></div>
<div class="line"><span class="lineno">  231</span>                current_datetime = datetime.now()</div>
<div class="line"><span class="lineno">  232</span>                current_date = current_datetime.strftime(<span class="stringliteral">&quot;%A, %d %B %Y&quot;</span>)  <span class="comment"># Giorno, data (es. Luned√¨, 26 Aprile 2025)</span></div>
<div class="line"><span class="lineno">  233</span>                current_time_str = current_datetime.strftime(<span class="stringliteral">&quot;%H:%M:%S&quot;</span>)  <span class="comment"># Ora in formato HH:MM:SS</span></div>
<div class="line"><span class="lineno">  234</span>                </div>
<div class="line"><span class="lineno">  235</span>                <span class="comment">#bot_manager.get_bot(&quot;whatsapp&quot;, chat_id, client_id).receive_message(received_message, chat_id, client_id, current_time, current_date)</span></div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>                eventi = session.query(<a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>).all()</div>
<div class="line"><span class="lineno">  238</span>                eventi_str = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  239</span>                <span class="keywordflow">for</span> evento <span class="keywordflow">in</span> eventi:</div>
<div class="line"><span class="lineno">  240</span>                    eventi_str += f<span class="stringliteral">&quot;Evento: {evento.name}\n&quot;</span></div>
<div class="line"><span class="lineno">  241</span>                    eventi_str += f<span class="stringliteral">&quot;Descrizione: {evento.description}\n&quot;</span></div>
<div class="line"><span class="lineno">  242</span>                    eventi_str += f<span class="stringliteral">&quot;Data e Ora: {evento.date_time.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;)}\n&quot;</span></div>
<div class="line"><span class="lineno">  243</span>                    eventi_str += f<span class="stringliteral">&quot;Location: {evento.location}\n&quot;</span></div>
<div class="line"><span class="lineno">  244</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Totali: {evento.total_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">  245</span>                    eventi_str += f<span class="stringliteral">&quot;Posti Disponibili: {evento.available_sits}\n&quot;</span></div>
<div class="line"><span class="lineno">  246</span>                    eventi_str += <span class="stringliteral">&quot;---------------------------\n&quot;</span> </div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>                <span class="keywordflow">if</span> data.get(<span class="stringliteral">&quot;object&quot;</span>) == <span class="stringliteral">&quot;whatsapp_business_account&quot;</span>:</div>
<div class="line"><span class="lineno">  249</span>                    <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> data.get(<span class="stringliteral">&quot;entry&quot;</span>, []):</div>
<div class="line"><span class="lineno">  250</span>                        <span class="keywordflow">for</span> change <span class="keywordflow">in</span> entry.get(<span class="stringliteral">&quot;changes&quot;</span>, []):</div>
<div class="line"><span class="lineno">  251</span>                            value = change.get(<span class="stringliteral">&quot;value&quot;</span>, {})</div>
<div class="line"><span class="lineno">  252</span>                            messages = value.get(<span class="stringliteral">&quot;messages&quot;</span>, [])</div>
<div class="line"><span class="lineno">  253</span>                            <span class="keywordflow">for</span> message <span class="keywordflow">in</span> messages:</div>
<div class="line"><span class="lineno">  254</span>                                sender_id = message[<span class="stringliteral">&quot;from&quot;</span>]  <span class="comment"># ‚Üê questo √® il numero WhatsApp del mittente</span></div>
<div class="line"><span class="lineno">  255</span>                                bot = bot_manager.create_if_not_exist_and_start_bot(<span class="stringliteral">&quot;telegram&quot;</span>, id=sender_id)</div>
<div class="line"><span class="lineno">  256</span>                                <span class="keywordflow">if</span> message.get(<span class="stringliteral">&quot;text&quot;</span>):</div>
<div class="line"><span class="lineno">  257</span>                                    received_message = message[<span class="stringliteral">&quot;text&quot;</span>][<span class="stringliteral">&quot;body&quot;</span>]</div>
<div class="line"><span class="lineno">  258</span>                                    bot.receive_message(payload=received_message, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  259</span>                                    prompt2=f<span class="stringliteral">&#39;&#39;&#39;Se l&#39;utente sta prenotando uno degli eventi in &quot;{eventi_str}&quot; nel suo messaggio: &quot;{received_message}&quot;, estrai le informazioni che ti fornisce e se non le d√† tutte, omettile. Foriscile nella forma:</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">                                    nome: ..., </span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">                                    evento: ..., </span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">                                    numero posti: .... </span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">                                    In questo messaggio fornisci SOLO le info che ti sono state fornite in &quot;{received_message}&quot; senza altre parole in una unica riga.</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">                                    Se l&#39;utente sta chidendo informazioni sugli eventi o sta chiedendo di cancellare una prenotazione rispondi con: </span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">                                    nome: ..., </span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">                                    evento: ..., </span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">                                    numero posti: ....  </span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">                                    ma lasciando tutti i campi vuoti.&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  269</span>                                    booking_state = <a class="code hl_function" href="namespacellm.html#a92bfc5a8d1c0a36739d7d6422dcd00f1">llm.ask_llm3</a>(sender_id, prompt2)</div>
<div class="line"><span class="lineno">  270</span>                                    info_message = f<span class="stringliteral">&quot;{booking_state}&quot;</span></div>
<div class="line"><span class="lineno">  271</span>                                    print(f<span class="stringliteral">&quot;Stato prenotazione utente {sender_id}: {booking_state}&quot;</span>)</div>
<div class="line"><span class="lineno">  272</span>                                    user_info = database.db.info_extraction(sender_id, info_message)</div>
<div class="line"><span class="lineno">  273</span>                                    print(f<span class="stringliteral">&quot;Stato prenotazione utente {sender_id}: {user_info}&quot;</span>)</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>                                    <span class="keywordflow">if</span> all([user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>]]):</div>
<div class="line"><span class="lineno">  276</span>                                        database.db.salva_prenotazione(user_info[<span class="stringliteral">&#39;name&#39;</span>], user_info[<span class="stringliteral">&#39;event&#39;</span>], user_info[<span class="stringliteral">&#39;number_sits&#39;</span>])</div>
<div class="line"><span class="lineno">  277</span>                    </div>
<div class="line"><span class="lineno">  278</span>                                        <span class="comment"># Genera la risposta finale con GPT</span></div>
<div class="line"><span class="lineno">  279</span>                                        prompt_finale = f<span class="stringliteral">&quot;Conferma la prenotazione per {user_info[&#39;name&#39;]} all&#39;evento {user_info[&#39;event&#39;]} con {user_info[&#39;number_sits&#39;]} posti.&quot;</span></div>
<div class="line"><span class="lineno">  280</span>                                        <span class="comment">#standard_text = f&quot;{prompt_finale}&quot;</span></div>
<div class="line"><span class="lineno">  281</span>                                        </div>
<div class="line"><span class="lineno">  282</span>                                        bot.send_message(payload=prompt_finale, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  283</span>                                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  284</span>                                        prompt = f<span class="stringliteral">&#39;&#39;&#39;L&#39;utente ha scritto: &quot;{received_message}&quot;, il giorno √® &quot;{current_date}&quot; e l&#39;ora √® &quot;{current_time_str}&quot;.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">                                        Per prenotare l&#39;utente deve fornire nome, cognome, evento e numero posti, non necessariamente in un unico messaggio, fino a riempire tutti i campi del dizionario &quot;{user_info}&quot;. </span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">                                        Questa √® la tabella degli eventi &quot;{eventi_str}&quot;.</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">                                        Se il numero di posti richiesti per uno degli eventi disponibili in &quot;{eventi_str}&quot; √® maggiore dei posti disponibili, rispondi con &quot;Posti non disponibili&quot; e dicendo quanti posti disponibili rimangono. </span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">                                        Se l&#39;utente chiede informazioni sugli eventi disponibili in &quot;{eventi_str}&quot;, forniscigliele dando SOLO le info che ti sta chiedendo e includendo qualche emoji.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">                                        Solo al primo messaggio presentati come Chat CPI, il chatbot ufficiale del circolo Peppino Impastato. </span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">                                        Usa un linguaggio inclusivo con la schwa (…ô).</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">                                        Rendi la risposta il pi√π sintentica possibile.</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">                                        Non dare MAI il messaggio di prenotazione effettuata.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">                                        Se l&#39;utente vuole cancellare una prenotazione, devi dire di rivolgersi al numero 3276233773</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">                                        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  295</span>                                        answer = <a class="code hl_function" href="namespacellm.html#a71ee9b464f51902803dbeb01d9396b22">llm.ask_llm</a>(sender_id, prompt)</div>
<div class="line"><span class="lineno">  296</span>                                        bot.send_message(payload=f<span class="stringliteral">&quot;{answer}&quot;</span>, datetime=current_datetime)</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>                            session.close()    </div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;EVENT_RECEIVED&#39;</span>, 200</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>        <span class="preprocessor">@self.webApp.route(&#39;/&#39;)</span></div>
<div class="line"><span class="lineno">  303</span>        <span class="keyword">def </span>home():</div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">return</span> render_template_string(web_client.html_home)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        <span class="comment"># Route che gestisce le operazioni sulla stessa pagina</span></div>
<div class="line"><span class="lineno">  307</span>        <span class="preprocessor">@self.webApp.route(self.srv_reservation_method, methods=[&#39;GET&#39;, &#39;POST&#39;])</span></div>
<div class="line"><span class="lineno">  308</span>        <span class="keyword">def </span>reservate():</div>
<div class="line"><span class="lineno">  309</span>            session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()  </div>
<div class="line"><span class="lineno">  310</span>            prenotazione = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  311</span>            somma_posti = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  312</span>            messaggio = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">if</span> request.method == <span class="stringliteral">&#39;POST&#39;</span>:</div>
<div class="line"><span class="lineno">  315</span>                azione = request.form.get(<span class="stringliteral">&#39;azione&#39;</span>)</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">if</span> azione == <span class="stringliteral">&#39;verifica&#39;</span>:  <span class="comment"># Verifica prenotazione</span></div>
<div class="line"><span class="lineno">  318</span>                    nome_verifica = request.form[<span class="stringliteral">&#39;nome_verifica&#39;</span>]</div>
<div class="line"><span class="lineno">  319</span>                    session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()</div>
<div class="line"><span class="lineno">  320</span>                    prenotazione = session.query(<a class="code hl_class" href="classdatabase_1_1Booking.html">database.Booking</a>).filter(database.Booking.name.ilike(nome_verifica)).all()</div>
<div class="line"><span class="lineno">  321</span>                    session.close()</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>                    <span class="keywordflow">if</span> <span class="keywordflow">not</span> prenotazione:</div>
<div class="line"><span class="lineno">  324</span>                        messaggio = f<span class="stringliteral">&quot;Non √® stata trovata nessuna prenotazione per il nome ¬´{nome_verifica}¬ª.&quot;</span></div>
<div class="line"><span class="lineno">  325</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  326</span>                        <span class="comment"># Costruiamo un messaggio riepilogativo di tutte le prenotazioni</span></div>
<div class="line"><span class="lineno">  327</span>                        lines = [f<span class="stringliteral">&quot;Prenotazioni trovate per ¬´{nome_verifica}¬ª:&quot;</span>]</div>
<div class="line"><span class="lineno">  328</span>                        <span class="keywordflow">for</span> p <span class="keywordflow">in</span> prenotazione:</div>
<div class="line"><span class="lineno">  329</span>                            lines.append(f<span class="stringliteral">&quot;- {p.name} ‚Üí evento ¬´{p.event}¬ª, {p.number_sits} posti&quot;</span>)</div>
<div class="line"><span class="lineno">  330</span>                        messaggio = <span class="stringliteral">&quot;\n&quot;</span>.join(lines)</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>                <span class="keywordflow">elif</span> azione == <span class="stringliteral">&#39;cancella&#39;</span>:  <span class="comment"># Cancellazione prenotazione</span></div>
<div class="line"><span class="lineno">  333</span>                    nome_cancellazione = request.form[<span class="stringliteral">&#39;nome_cancellazione&#39;</span>]</div>
<div class="line"><span class="lineno">  334</span>                    session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()</div>
<div class="line"><span class="lineno">  335</span>                    prenotazione = session.query(<a class="code hl_class" href="classdatabase_1_1Booking.html">database.Booking</a>).filter_by(name=nome_cancellazione).first()</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>                    <span class="keywordflow">if</span> prenotazione:</div>
<div class="line"><span class="lineno">  338</span>                        session.delete(prenotazione)</div>
<div class="line"><span class="lineno">  339</span>                        session.commit()</div>
<div class="line"><span class="lineno">  340</span>                        messaggio = f<span class="stringliteral">&quot;La prenotazione per {nome_cancellazione} √® stata cancellata con successo.&quot;</span></div>
<div class="line"><span class="lineno">  341</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  342</span>                        messaggio = f<span class="stringliteral">&quot;Non √® stata trovata nessuna prenotazione per il nome {nome_cancellazione}.&quot;</span></div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>                    session.close()</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>                <span class="keywordflow">elif</span> azione == <span class="stringliteral">&quot;inserisci&quot;</span>:</div>
<div class="line"><span class="lineno">  347</span>                    nome = request.form.get(<span class="stringliteral">&quot;nome_inserimento&quot;</span>)</div>
<div class="line"><span class="lineno">  348</span>                    evento = request.form.get(<span class="stringliteral">&quot;evento_inserimento&quot;</span>)</div>
<div class="line"><span class="lineno">  349</span>                    posti = request.form.get(<span class="stringliteral">&quot;posti_inserimento&quot;</span>)</div>
<div class="line"><span class="lineno">  350</span>                    session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>                    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  353</span>                        posti = int(posti)</div>
<div class="line"><span class="lineno">  354</span>                        nuova_prenotazione = <a class="code hl_class" href="classdatabase_1_1Booking.html">database.Booking</a>(name=nome, event=evento, number_sits=posti)</div>
<div class="line"><span class="lineno">  355</span>                        session.add(nuova_prenotazione)</div>
<div class="line"><span class="lineno">  356</span>                        event = session.query(<a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>).filter_by(name=evento).first()</div>
<div class="line"><span class="lineno">  357</span>                        event.available_sits -= posti</div>
<div class="line"><span class="lineno">  358</span>                        session.commit()</div>
<div class="line"><span class="lineno">  359</span>                        messaggio = f<span class="stringliteral">&quot;Prenotazione per {nome} all&#39;evento &#39;{evento}&#39; aggiunta con successo.&quot;</span></div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>                    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  362</span>                        session.rollback()</div>
<div class="line"><span class="lineno">  363</span>                        messaggio = f<span class="stringliteral">&quot;Errore durante l&#39;inserimento: {e}&quot;</span></div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>                    session.close()            </div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>                <span class="keywordflow">elif</span> azione == <span class="stringliteral">&#39;somma_posti&#39;</span>:  <span class="comment"># Somma dei posti prenotati per evento</span></div>
<div class="line"><span class="lineno">  368</span>                    session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()</div>
<div class="line"><span class="lineno">  369</span>                    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  370</span>                        somma_posti = (</div>
<div class="line"><span class="lineno">  371</span>                        session.query(database.Booking.event, func.sum(database.Booking.number_sits).label(<span class="stringliteral">&#39;total_posti&#39;</span>))</div>
<div class="line"><span class="lineno">  372</span>                        .group_by(database.Booking.event)</div>
<div class="line"><span class="lineno">  373</span>                        .all()</div>
<div class="line"><span class="lineno">  374</span>                        )</div>
<div class="line"><span class="lineno">  375</span>                    <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  376</span>                        session.close()</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>            <span class="comment">#Recupera tutte le prenotazioni per visualizzarle sempre</span></div>
<div class="line"><span class="lineno">  379</span>            prenotazioni_per_evento = defaultdict(list)</div>
<div class="line"><span class="lineno">  380</span>            <span class="keywordflow">for</span> p <span class="keywordflow">in</span> session.query(<a class="code hl_class" href="classdatabase_1_1Booking.html">database.Booking</a>).order_by(database.Booking.event).all():</div>
<div class="line"><span class="lineno">  381</span>                prenotazioni_per_evento[p.event].append(p)</div>
<div class="line"><span class="lineno">  382</span>            session.close()</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">return</span> render_template_string(web_client.html_reservation, prenotazione=prenotazione, somma_posti=somma_posti, messaggio=messaggio,prenotazioni_per_evento=prenotazioni_per_evento )</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        <span class="preprocessor">@self.webApp.route(self.srv_event_info_method, methods=[&quot;GET&quot;, &quot;POST&quot;])</span></div>
<div class="line"><span class="lineno">  388</span>        <span class="keyword">def </span>get_event_info():</div>
<div class="line"><span class="lineno">  389</span>            session = <a class="code hl_variable" href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a>()  <span class="comment"># &lt;&lt;--- crea la sessione</span></div>
<div class="line"><span class="lineno">  390</span>            messaggio = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>            <span class="keywordflow">if</span> request.method == <span class="stringliteral">&quot;POST&quot;</span>:</div>
<div class="line"><span class="lineno">  393</span>                nome_evento = request.form.get(<span class="stringliteral">&quot;nome_evento&quot;</span>)  </div>
<div class="line"><span class="lineno">  394</span>                descrizione = request.form.get(<span class="stringliteral">&quot;descrizione_evento&quot;</span>)</div>
<div class="line"><span class="lineno">  395</span>                luogo = request.form.get(<span class="stringliteral">&quot;location_evento&quot;</span>)</div>
<div class="line"><span class="lineno">  396</span>                posti_disponibili = request.form.get(<span class="stringliteral">&quot;posti_disponibili&quot;</span>)</div>
<div class="line"><span class="lineno">  397</span>                posti_totali = request.form.get(<span class="stringliteral">&quot;posti_totali&quot;</span>)</div>
<div class="line"><span class="lineno">  398</span>                data_evento = request.form.get(<span class="stringliteral">&quot;data_evento&quot;</span>)</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>                print(nome_evento)</div>
<div class="line"><span class="lineno">  401</span>                print(descrizione)</div>
<div class="line"><span class="lineno">  402</span>                print(data_evento)</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  405</span>                    <span class="comment"># Conversione robusta della data</span></div>
<div class="line"><span class="lineno">  406</span>                    data_evento = data_evento.strip().replace(<span class="stringliteral">&quot;:&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>, 2)</div>
<div class="line"><span class="lineno">  407</span>                    data_evento = datetime.strptime(data_evento, <span class="stringliteral">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</div>
<div class="line"><span class="lineno">  408</span>                    posti_disponibili = int(posti_disponibili)</div>
<div class="line"><span class="lineno">  409</span>                    posti_totali = int(posti_totali)</div>
<div class="line"><span class="lineno">  410</span>            </div>
<div class="line"><span class="lineno">  411</span>                    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  412</span>                        nuovo_evento = <a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>(</div>
<div class="line"><span class="lineno">  413</span>                            name=nome_evento,</div>
<div class="line"><span class="lineno">  414</span>                            description=descrizione,</div>
<div class="line"><span class="lineno">  415</span>                            location=luogo,</div>
<div class="line"><span class="lineno">  416</span>                            available_sits=posti_disponibili,</div>
<div class="line"><span class="lineno">  417</span>                            total_sits=posti_totali,</div>
<div class="line"><span class="lineno">  418</span>                            date_time=data_evento,</div>
<div class="line"><span class="lineno">  419</span>                        )</div>
<div class="line"><span class="lineno">  420</span>                    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  421</span>                        session.rollback()</div>
<div class="line"><span class="lineno">  422</span>                        messaggio = f<span class="stringliteral">&quot;Exception: {e}&quot;</span></div>
<div class="line"><span class="lineno">  423</span>                        print(messaggio)</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>                    session.add(nuovo_evento)</div>
<div class="line"><span class="lineno">  426</span>                    session.commit()</div>
<div class="line"><span class="lineno">  427</span>                    messaggio = f<span class="stringliteral">&quot;Evento &#39;{nome_evento}&#39; aggiunto con successo.&quot;</span></div>
<div class="line"><span class="lineno">  428</span>                    print(messaggio)</div>
<div class="line"><span class="lineno">  429</span>                <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> ve:</div>
<div class="line"><span class="lineno">  430</span>                    session.rollback()</div>
<div class="line"><span class="lineno">  431</span>                    messaggio = f<span class="stringliteral">&quot;Errore nel formato della data: {ve}&quot;</span></div>
<div class="line"><span class="lineno">  432</span>                    print(messaggio)</div>
<div class="line"><span class="lineno">  433</span>                <span class="keywordflow">except</span> SQLAlchemyError <span class="keyword">as</span> se:</div>
<div class="line"><span class="lineno">  434</span>                    session.rollback()</div>
<div class="line"><span class="lineno">  435</span>                    messaggio = f<span class="stringliteral">&quot;Errore nel salvataggio sul database: {se}&quot;</span></div>
<div class="line"><span class="lineno">  436</span>                    print(messaggio)</div>
<div class="line"><span class="lineno">  437</span>                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  438</span>                    session.rollback()</div>
<div class="line"><span class="lineno">  439</span>                    messaggio = f<span class="stringliteral">&quot;Exception: {e}&quot;</span></div>
<div class="line"><span class="lineno">  440</span>                    print(messaggio)</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>            <span class="comment"># Recupera sempre tutti gli eventi (anche dopo errori)</span></div>
<div class="line"><span class="lineno">  444</span>            eventi = session.query(<a class="code hl_class" href="classdatabase_1_1Event.html">database.Event</a>).all()</div>
<div class="line"><span class="lineno">  445</span>            session.close()</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>            <span class="keywordflow">return</span> render_template_string(web_client.html_events, eventi=eventi, messaggio=messaggio)</div>
<div class="line"><span class="lineno">  448</span>        </div>
<div class="line"><span class="lineno">  449</span>        <span class="preprocessor">@self.webApp.route(&quot;/__shutdown__&quot;, methods=[&quot;GET&quot;])</span></div>
<div class="line"><span class="lineno">  450</span>        <span class="keyword">def </span>shutdown():</div>
<div class="line"><span class="lineno">  451</span>            shutdown_func = request.environ.get(<span class="stringliteral">&quot;werkzeug.server.shutdown&quot;</span>)</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">if</span> shutdown_func <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  453</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;Not running with the Werkzeug Server&quot;</span>)</div>
<div class="line"><span class="lineno">  454</span>            shutdown_func()</div>
<div class="line"><span class="lineno">  455</span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;Server shutting down...&quot;</span></div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="ttc" id="aclassdatabase_1_1Booking_html"><div class="ttname"><a href="classdatabase_1_1Booking.html">database.Booking</a></div><div class="ttdef"><b>Definition</b> <a href="database_8py_source.html#l00009">database.py:9</a></div></div>
<div class="ttc" id="aclassdatabase_1_1Event_html"><div class="ttname"><a href="classdatabase_1_1Event.html">database.Event</a></div><div class="ttdef"><b>Definition</b> <a href="database_8py_source.html#l00020">database.py:20</a></div></div>
<div class="ttc" id="anamespacedatabase_html_aea433d84efd1b9a5b50578a3b4dccd5a"><div class="ttname"><a href="namespacedatabase.html#aea433d84efd1b9a5b50578a3b4dccd5a">database.Session</a></div><div class="ttdeci">Session</div><div class="ttdef"><b>Definition</b> <a href="database_8py_source.html#l00006">database.py:6</a></div></div>
<div class="ttc" id="anamespacellm_html_a71ee9b464f51902803dbeb01d9396b22"><div class="ttname"><a href="namespacellm.html#a71ee9b464f51902803dbeb01d9396b22">llm.ask_llm</a></div><div class="ttdeci">ask_llm(user_id, prompt)</div><div class="ttdef"><b>Definition</b> <a href="llm_8py_source.html#l00026">llm.py:26</a></div></div>
<div class="ttc" id="anamespacellm_html_a92bfc5a8d1c0a36739d7d6422dcd00f1"><div class="ttname"><a href="namespacellm.html#a92bfc5a8d1c0a36739d7d6422dcd00f1">llm.ask_llm3</a></div><div class="ttdeci">ask_llm3(user_id, prompt)</div><div class="ttdef"><b>Definition</b> <a href="llm_8py_source.html#l00100">llm.py:100</a></div></div>
<div class="ttc" id="anamespacellm_html_ab5107623e8d5c3a898f4576ec17b294b"><div class="ttname"><a href="namespacellm.html#ab5107623e8d5c3a898f4576ec17b294b">llm.info_extraction</a></div><div class="ttdeci">info_extraction(user_id, message)</div><div class="ttdef"><b>Definition</b> <a href="llm_8py_source.html#l00147">llm.py:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="llm_8py_source.html#l00026">llm.ask_llm()</a>, <a class="el" href="llm_8py_source.html#l00100">llm.ask_llm3()</a>, <a class="el" href="llm_8py_source.html#l00147">llm.info_extraction()</a>, and <a class="el" href="database_8py_source.html#l00006">database.Session</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classweb__server_1_1WebApp_a26c3a90dc19e72de409e728a750a6d24_cgraph.svg" width="362" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a857b65105ee8b50f7e981cbde3e96c8f" name="a857b65105ee8b50f7e981cbde3e96c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a857b65105ee8b50f7e981cbde3e96c8f">&#9670;&#160;</a></span>configure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.configure </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00471">471</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  471</span>    <span class="keyword">def </span>configure(self):</div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  473</span>            main_logger.info(<span class="stringliteral">&quot;Configuring App&quot;</span>)</div>
<div class="line"><span class="lineno">  474</span>            </div>
<div class="line"><span class="lineno">  475</span>            config.configure()</div>
<div class="line"><span class="lineno">  476</span>            self.webapp_logger.config(min_level=<span class="stringliteral">&quot;DEBUG&quot;</span>, encoding=<span class="stringliteral">&quot;utf-8&quot;</span>)</div>
<div class="line"><span class="lineno">  477</span>            </div>
<div class="line"><span class="lineno">  478</span>            main_logger.info(<span class="stringliteral">&quot;Configuring App complete successfully&quot;</span>)</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">except</span> ConfigurationException <span class="keyword">as</span> ce:</div>
<div class="line"><span class="lineno">  480</span>            main_logger.critical(msg=ce, exc_info=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">raise</span> ce</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  483</span>            main_logger.critical(msg=e, exc_info=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  484</span>            <span class="keywordflow">raise</span> e</div>
<div class="line"><span class="lineno">  485</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="web__server_8py_source.html#l00061">web_server.WebApp.webapp_logger</a>.</p>

</div>
</div>
<a id="a4cce6ba1e1a44470e642999fc1bec514" name="a4cce6ba1e1a44470e642999fc1bec514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cce6ba1e1a44470e642999fc1bec514">&#9670;&#160;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.start </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00457">457</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  457</span>    <span class="keyword">def </span>start(self, **kwargs):</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> self.webapp_thread <span class="keywordflow">and</span> self.webapp_thread.is_alive():</div>
<div class="line"><span class="lineno">  459</span>            main_logger.warning(<span class="stringliteral">&quot;Flask gi√† in esecuzione&quot;</span>)</div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>        <span class="keyword">def </span>run_app():</div>
<div class="line"><span class="lineno">  463</span>            main_logger.info(f<span class="stringliteral">&quot;Starting App on http://{self.srv_host}:{self.srv_port}&quot;</span>)</div>
<div class="line"><span class="lineno">  464</span>            self.webApp.run(host=self.srv_host, port=self.srv_port, use_reloader=<span class="keyword">False</span>, **kwargs)</div>
<div class="line"><span class="lineno">  465</span>            main_logger.info(<span class="stringliteral">&quot;App stopped&quot;</span>)</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>        self.webapp_thread = threading.Thread(target=run_app, daemon=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  468</span>        self.webapp_thread.start()</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="web__server_8py_source.html#l00046">web_server.WebApp.srv_host</a>, <a class="el" href="web__server_8py_source.html#l00047">web_server.WebApp.srv_port</a>, <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>, <a class="el" href="web__server_8py_source.html#l00049">web_server.WebApp.webApp</a>, and <a class="el" href="web__server_8py_source.html#l00059">web_server.WebApp.webapp_thread</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classweb__server_1_1WebApp_a4cce6ba1e1a44470e642999fc1bec514_cgraph.svg" width="198" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classweb__server_1_1WebApp_a4cce6ba1e1a44470e642999fc1bec514_icgraph.svg" width="198" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad0b330da0dc4521360db9cf1132aff39" name="ad0b330da0dc4521360db9cf1132aff39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b330da0dc4521360db9cf1132aff39">&#9670;&#160;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.stop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00500">500</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  500</span>    <span class="keyword">def </span>stop(self):</div>
<div class="line"><span class="lineno">  501</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  502</span>            requests.get(self.srv_shutdown_api)</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">  504</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">if</span> self.webapp_thread:</div>
<div class="line"><span class="lineno">  507</span>            self.webapp_thread.join(timeout=5)</div>
<div class="line"><span class="lineno">  508</span>            </div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">class Network:</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        network_queue = queue.Queue()</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">        network_stop_event = threading.Event()</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        network_condition = threading.Condition()</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">        network_thread: Optional[threading.Thread] = None</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">        def __init__(self):</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">            self._configured = False</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">        def config(self):</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">            if self._configured:</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">                return</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">            try:</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">                self._configured = True</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">            except Exception as e:</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">                raise e</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">        def verifyUrl(self, url: str) :</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">            try:</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">                return True</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">            except Exception as e:</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">                raise e</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">        def verifyConnection(self) -&gt; bool:</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">            try:</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">                return True</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">            except Exception as e:</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">                raise e</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">        @classmethod</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        def network_manager_run(cls):</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">            while not cls.network_stop_event.is_set():</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">                with cls.network_condition:</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">                    try:</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">                        pass</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">                    except Exception as e:</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">                        print(f&quot;{e}&quot;, file=sys.stderr)</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        @classmethod</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        def start_network_manager(cls, thread_name: str = &quot;NetworkThread&quot;, daemon: bool = True, **thread_kwargs):</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">            try:</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">                if cls.network_thread is None or not cls.network_thread.is_alive():</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">                    cls.network_stop_event.clear()</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">                    cls.network_thread = threading.Thread(</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">                        target=cls.network_manager_run,</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">                        name=thread_name,</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">                        daemon=daemon,</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">                        **thread_kwargs</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">                    )</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">                    cls.network_thread.start()</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">                print(f&quot;Networking Thread &#39;{thread_name}&#39; Started&quot;)</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">            except Exception as e:</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">                raise e</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">        @classmethod</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">        def shutdown_network_manager(cls):</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">            cls.network_stop_event.set()</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">            with cls.network_condition:</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">                cls.network_condition.notify_all()</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">            if cls.network_thread and cls.network_thread.is_alive():</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">                cls.network_thread.join()</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">            else:</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">                raise Exception(&quot;Unable to close NetworkThread at Shutdown&quot;)</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="web__server_8py_source.html#l00057">web_server.WebApp.srv_shutdown_api</a>, and <a class="el" href="web__server_8py_source.html#l00059">web_server.WebApp.webapp_thread</a>.</p>

<p class="reference">Referenced by <a class="el" href="bot_8py_source.html#l00374">bot.Bot.__del__()</a>, and <a class="el" href="bot_8py_source.html#l00751">bot.BotManager.__del__()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classweb__server_1_1WebApp_ad0b330da0dc4521360db9cf1132aff39_icgraph.svg" width="422" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa4a83dca41a9804d8149bbbae5dfc0b1" name="aa4a83dca41a9804d8149bbbae5dfc0b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a83dca41a9804d8149bbbae5dfc0b1">&#9670;&#160;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.verify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00486">486</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  486</span>    <span class="keyword">def </span>verify(self):</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  488</span>            main_logger.info(<span class="stringliteral">&quot;Verifing App&quot;</span>)</div>
<div class="line"><span class="lineno">  489</span>            config.verify_ngrok()</div>
<div class="line"><span class="lineno">  490</span>            main_logger.info(<span class="stringliteral">&quot;Verify App complete successfully&quot;</span>)</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordflow">except</span> ConfigurationVerifyNgrokException <span class="keyword">as</span> vne:</div>
<div class="line"><span class="lineno">  492</span>            main_logger.critical(<span class="stringliteral">&quot;Verify Ngrok failed&quot;</span>)</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">raise</span> vne</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">except</span> ConfigurationException <span class="keyword">as</span> ce:</div>
<div class="line"><span class="lineno">  495</span>            main_logger.critical(msg=ce, exc_info=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  497</span>            main_logger.critical(msg=e, exc_info=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">raise</span> e</div>
<div class="line"><span class="lineno">  499</span>        </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac7c34c719a5f7a30c7068bc7991f4156" name="ac7c34c719a5f7a30c7068bc7991f4156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c34c719a5f7a30c7068bc7991f4156">&#9670;&#160;</a></span>fb_bot_webhook_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.fb_bot_webhook_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00052">52</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="ad269ae2bcc4a269d7f52b3077d5f331d" name="ad269ae2bcc4a269d7f52b3077d5f331d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad269ae2bcc4a269d7f52b3077d5f331d">&#9670;&#160;</a></span>srv_event_info_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_event_info_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00055">55</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="a33d43f30c0f191b2d0648d5fb055821c" name="a33d43f30c0f191b2d0648d5fb055821c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33d43f30c0f191b2d0648d5fb055821c">&#9670;&#160;</a></span>srv_host</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_host</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00046">46</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>.</p>

</div>
</div>
<a id="af120abb2c4437b28e85f481f2523f50c" name="af120abb2c4437b28e85f481f2523f50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af120abb2c4437b28e85f481f2523f50c">&#9670;&#160;</a></span>srv_port</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_port</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00047">47</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>.</p>

</div>
</div>
<a id="a305d98e65ac1e5363e83a0a9fafcab3a" name="a305d98e65ac1e5363e83a0a9fafcab3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305d98e65ac1e5363e83a0a9fafcab3a">&#9670;&#160;</a></span>srv_proto</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_proto</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00048">48</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="a986335c380cfdfecc78f5d612f73f87c" name="a986335c380cfdfecc78f5d612f73f87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986335c380cfdfecc78f5d612f73f87c">&#9670;&#160;</a></span>srv_reservation_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_reservation_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00054">54</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="a25b1133c0c3d6ae5bcbb185a114bd605" name="a25b1133c0c3d6ae5bcbb185a114bd605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b1133c0c3d6ae5bcbb185a114bd605">&#9670;&#160;</a></span>srv_shutdown_api</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_shutdown_api</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00057">57</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00500">web_server.WebApp.stop()</a>.</p>

</div>
</div>
<a id="a2e3055f783fdad0070c444d258abd3af" name="a2e3055f783fdad0070c444d258abd3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3055f783fdad0070c444d258abd3af">&#9670;&#160;</a></span>srv_shutdown_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.srv_shutdown_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00056">56</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="a3453866068dea979ca6e6684fc774fbd" name="a3453866068dea979ca6e6684fc774fbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3453866068dea979ca6e6684fc774fbd">&#9670;&#160;</a></span>tg_bot_webhook_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.tg_bot_webhook_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00051">51</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<a id="a63787c15c6de39b65ed8af8d77a67ebd" name="a63787c15c6de39b65ed8af8d77a67ebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63787c15c6de39b65ed8af8d77a67ebd">&#9670;&#160;</a></span>webApp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.webApp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00049">49</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>.</p>

</div>
</div>
<a id="a1363b6fa76b54ba02f258305c40c3a05" name="a1363b6fa76b54ba02f258305c40c3a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1363b6fa76b54ba02f258305c40c3a05">&#9670;&#160;</a></span>webapp_logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.webapp_logger</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00061">61</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00471">web_server.WebApp.configure()</a>.</p>

</div>
</div>
<a id="a193a8e3946cccec4f4f03639996a1155" name="a193a8e3946cccec4f4f03639996a1155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a193a8e3946cccec4f4f03639996a1155">&#9670;&#160;</a></span>webapp_thread</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.webapp_thread</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00059">59</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="web__server_8py_source.html#l00457">web_server.WebApp.start()</a>, and <a class="el" href="web__server_8py_source.html#l00500">web_server.WebApp.stop()</a>.</p>

</div>
</div>
<a id="ac4679d81d01a436a228b43d1e089e672" name="ac4679d81d01a436a228b43d1e089e672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4679d81d01a436a228b43d1e089e672">&#9670;&#160;</a></span>wp_webhook_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">web_server.WebApp.wp_webhook_method</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="web__server_8py_source.html#l00053">53</a> of file <a class="el" href="web__server_8py_source.html">web_server.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/<a class="el" href="web__server_8py_source.html">web_server.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceweb__server.html">web_server</a></li><li class="navelem"><a class="el" href="classweb__server_1_1WebApp.html">WebApp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
<!-- ‚úÖ FOOTER PERSONALIZZATO - FUORI DAL NAVPATH -->
<div id="custom-footer">
  <!-- Sezione download / GitHub -->
  <div id="custom-footer-download" class="custom-footer-download">
    <a href="https://github.com/Unix69/README-Template/archive/refs/heads/main.zip" 
       class="btn-download" target="_blank">‚¨áÔ∏è Download</a>
    <a href="https://github.com/Unix69/EmbeddedDocsTemplates" 
       class="btn-github" target="_blank">üêô View on GitHub</a>
  </div>
  <!-- Sezione autore -->
  <div id="custom-footer-author" class="custom-footer-author">
    <img src="Images/Logo/GitHubLogo.svg" alt="GitHub" width="18px" height="18px">
    &copy; 2025 <b>Giuseppe Pedone</b> ‚Äî
    <a href="https://github.com/Unix69" target="_blank"><b>GitHub</b></a>
  </div>
</div>
<script src="link.js?v=12347"></script>
<script src="directory-tree.js?v=12348"></script>
</body>
</html>
